/*!
 *  build: vue-admin-better 
 *  vue-admin-beautiful.com 
 *  https://gitee.com/chu1204505056/vue-admin-better 
 *  time: 2023-10-6 09:04:45
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a27b012"],{"41c6":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("ImgSearch",{on:{handleImgSearch:e.onImgSearch}}),i("AlbumContainer",{attrs:{items:e.imgs.data,total:e.imgs.totalCnt,title:e.imgs.title,busy:e.imgs.loading,finished:e.imgs.finished},on:{albumClick:e.onRouteJump,load:e.onLoad}})],1)},s=[],l=i("41cf"),a=i("9d59"),o=i("4360"),c=i("5333"),r={name:"Album",components:{AlbumContainer:l["default"],ImgSearch:a["default"]},directives:{},props:{query:{type:Object,default:null,required:!1}},data:function(){return{imgs:{title:"Img List",loading:!1,finished:!1,checkedId:-1,checkedIndex:-1,totalCnt:0,links:null,curCnt:0,data:[],queryForm:{page:1,search:"",id:"",fc_nums:-1,fc_name:"",c_img:"",c_fore:"",c_back:"",address__is_located:"",address__city:"",address__longitude__range:"",address__latitude__range:"",user__username:o["default"].getters["user/username"]}}}},watch:{},created(){},mounted(){console.log("Gallery Index: mounted",this.imgs.queryForm),this.fetchImg()},methods:{onRouteJump(e,t){console.log("recieved the child component value %d,%o",e,t),this.imgs.checkedIndex=e,this.imgs.checkedId=t.id||0,this.$router.push({name:"Img",query:{id:t.id,title:t.name}})},async fetchImg(){console.log("Gallery Index: fetchImg"),this.imgs.loading=!0,this.imgs.finished=!1,await Object(c["getImg"])(this.imgs.queryForm).then(e=>{console.log("Gallery Index: getImg",e);const{data:t,totalCnt:i,links:n}=e;this.imgs.data=[...this.imgs.data,...t],this.imgs.curCnt=this.imgs.data.length,this.imgs.totalCnt=i,this.imgs.links=n,null===this.imgs.links.next&&(this.imgs.finished=!0),console.log("Gallery Index: emit imgData"),this.$emit("imgData",this.imgs.data),setTimeout(()=>{this.imgs.loading=!1},2e3)})},onLoad(){console.log("Gallery Index: onLoad, this.imgs.loading",this.imgs.loading),this.imgs.finished?setTimeout(()=>{this.imgs.loading=!1},3e3):(console.log("Gallery Index imgs.queryForm.page: ",this.imgs.queryForm.page),this.imgs.queryForm.page++,this.fetchImg())},onImgSearch(e){console.log("recieve the queryForm info from the search component"),console.log(e),this.imgs.queryForm=e,this.imgs.totalCnt=0,this.imgs.data=[],this.fetchImg()}}},d=r,m=i("2877"),u=Object(m["a"])(d,n,s,!1,null,null,null);t["default"]=u.exports},"41cf":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"album_container"},[i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],ref:"album_container",staticClass:"content",attrs:{id:"album_container","infinite-scroll-disabled":"busy","infinite-scroll-distance":"400","infinite-scroll-immediate-check":"true","force-use-infinite-wrapper":!0}},[e._l(e.items,(function(t,n){return i("div",{key:t.id,on:{click:function(i){return e.onClick(i,n,t)},dblclick:function(i){return e.onDoubleClick(i,n,t)}}},[i("el-tooltip",{attrs:{content:t.caption?t.caption:"No Caption",placement:"top"}},[i("img",{class:e.checkedIndex===n?"img-checked":"img-unchecked",attrs:{className:"img-responsive",src:t.thumb,alt:t.name}})]),i("div",{staticClass:"jg-caption"},[i("el-badge",{staticClass:"item",attrs:{value:t.value,max:99,type:"primary"}},[i("el-input",{staticClass:"item-name",staticStyle:{float:"left","font-size":"8px"},attrs:{size:"small",placeholder:"Change the Name"},on:{blur:function(i){return e.changeName(t.name,t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterBlur(t)}},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"item.name"}})],1)],1)],1)})),i("div",{directives:[{name:"show",rawName:"v-show",value:e.busy,expression:"busy"}],staticClass:"loading"},[i("h3",[e._v(e._s(e.msg))])])],2),i("el-divider",{directives:[{name:"show",rawName:"v-show",value:e.finished,expression:"finished"}]},[i("i",{staticClass:"el-icon-finished"})])],1)},s=[],l=i("1157"),a=i.n(l),o=(i("cfd5"),i("a809"),i("487a")),c=i.n(o),r={name:"AlbumContainer",directives:{infiniteScroll:c.a},props:{items:{type:Array,default:()=>Array(40).fill({}),required:!0},total:{type:Number,default:50,required:!0},title:{type:String,default:"Album",required:!0},busy:{type:Boolean,default:!1,required:!0},finished:{type:Boolean,default:!1,required:!1}},data(){return{msg:"正在加载...",intervalId:null,checkedIndex:-1,checkedId:0}},watch:{items(e,t){console.log("Album.content: Album numbers have been changed",e.length,this.total,this.msg),this.$nextTick(()=>{a()("#album_container").justifiedGallery()}),this.checkDivHeight()}},created(){console.log("Album.content: Album component created")},mounted(){this.justifyInit()},methods:{justifyInit:function(){a()("[id=album_container]").justifiedGallery({captions:!0,lastRow:"left",rowHeight:150,margins:5}).on("jg.complete",(function(){console.log("Album.content: jg.complete event was trigged")}))},onClick(e,t,i){console.log("Album.content: onClick: ",i),this.checkedIndex=t,t<0||null!==i&&(this.checkedId=i.id,this.$emit("albumClick",t,i))},onDoubleClick(e,t,i){console.log("Album.content: onDoubleClick"),this.$emit("doubleClick",t,i)},changeName(e,t){console.log("Album.content: changeName"),this.$emit("changeName",e,t)},enterBlur(e){console.log("Album.content: enterBlur"),e.target.blur()},load(){console.log("infinite loading... ",this.busy),this.busy||this.$emit("load")},checkDivHeight(){if(null===this.intervalId){var e=this.$refs.album_container;e&&(this.intervalId=setInterval(()=>{if(!1===this.busy){var t=e.scrollHeight,i=e.scrollTop,n=800;console.log("Gallery Contetn: checkDivHeight:divElement: The div is not filled.",i,t,n,this.finished),t>n||this.finished?(clearInterval(this.intervalId),this.intervalId=null,console.log("timer has been closed")):this.$emit("load")}},1e3))}else console.log("Gallery content: checkDivHeight: intervalId is not null")}}},d=r,m=(i("45ab"),i("2877")),u=Object(m["a"])(d,n,s,!1,null,"14aede40",null);t["default"]=u.exports},"45ab":function(e,t,i){"use strict";i("4cbf")},"4cbf":function(e,t,i){}}]);